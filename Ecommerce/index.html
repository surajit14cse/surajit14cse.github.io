<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Amar Dokan - Modern Marketplace</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Heroicons CDN for icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body {
            background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
            background-repeat: repeat;
            background-color: #f7f3ef;
        }
        /* Hide scrollbar for horizontal scroll sections */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Modal backdrop */
        .modal-bg {
            background: rgba(0,0,0,0.5);
        }
    </style>
</head>
<body class="min-h-screen font-sans">

    <!-- Header -->
    <header class="fixed top-0 left-0 w-full z-30 bg-white/90 shadow-md">
        <div class="max-w-7xl mx-auto flex items-center justify-between px-4 py-2">
            <!-- Logo -->
            <div class="flex items-center space-x-2">
                <span class="text-2xl font-bold text-amber-800 tracking-tight">Amar Dokan</span>
            </div>
            <!-- Search Bar -->
            <div class="flex-1 mx-4 hidden md:flex">
                <input type="text" id="searchInput" placeholder="Search for products..." class="w-full px-4 py-2 rounded-l-full border border-amber-200 focus:outline-none focus:ring-2 focus:ring-amber-400 transition" />
                <button id="searchBtn" class="px-4 py-2 bg-amber-700 text-white rounded-r-full hover:bg-amber-800 transition">
                    <i data-feather="search"></i>
                </button>
            </div>
            <!-- Icons -->
            <div class="flex items-center space-x-4">
                <button class="p-2 rounded-full hover:bg-amber-100 transition" title="Account">
                    <i data-feather="user"></i>
                </button>
                <button class="p-2 rounded-full hover:bg-amber-100 transition" title="Favorites">
                    <i data-feather="heart"></i>
                </button>
                <button class="relative p-2 rounded-full hover:bg-amber-100 transition" title="Cart" id="cartBtn">
                    <i data-feather="shopping-cart"></i>
                    <span id="cartCount" class="absolute -top-1 -right-1 bg-red-600 text-white text-xs rounded-full px-1.5 py-0.5 font-bold">0</span>
                </button>
                <button class="px-4 py-1 rounded-full bg-amber-700 text-white font-semibold shadow hover:bg-amber-800 transition duration-200 text-sm">Login</button>
                <button class="px-4 py-1 rounded-full bg-white border border-amber-700 text-amber-800 font-semibold shadow hover:bg-amber-100 transition duration-200 text-sm">Sign Up</button>
            </div>
            <!-- Mobile search -->
            <button class="md:hidden p-2 ml-2 rounded-full hover:bg-amber-100 transition" id="mobileSearchBtn">
                <i data-feather="search"></i>
            </button>
        </div>
        <!-- Mobile search bar -->
        <div class="md:hidden px-4 pb-2 hidden" id="mobileSearchBar">
            <input type="text" id="mobileSearchInput" placeholder="Search for products..." class="w-full px-4 py-2 rounded-full border border-amber-200 focus:outline-none focus:ring-2 focus:ring-amber-400 transition" />
        </div>
    </header>

    <!-- Sidebar Navigation (collapsible on mobile) -->
    <aside class="fixed top-16 left-0 h-[calc(100vh-4rem)] w-56 bg-white/95 shadow-lg z-20 hidden md:block">
        <nav class="py-6 px-4 space-y-2">
            <h2 class="text-lg font-bold text-amber-800 mb-4">Categories</h2>
            <ul id="categoryList" class="space-y-2">
                <!-- Categories will be injected here -->
            </ul>
        </nav>
    </aside>
    <!-- Mobile category bar -->
    <div class="md:hidden fixed top-16 left-0 w-full bg-white/95 shadow z-20 overflow-x-auto no-scrollbar">
        <nav class="flex space-x-4 px-4 py-2" id="mobileCategoryList">
            <!-- Categories will be injected here -->
        </nav>
    </div>

    <!-- Main Content -->
    <main class="pt-24 md:pl-60 max-w-7xl mx-auto px-2 md:px-6">

        <!-- Hero Carousel -->
        <section class="mb-8">
            <div class="relative rounded-xl overflow-hidden shadow-lg bg-white">
                <div id="carouselSlides" class="relative h-56 md:h-80">
                    <!-- Slides will be injected here -->
                </div>
                <!-- Carousel Controls -->
                <button id="carouselPrev" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-amber-100 rounded-full p-2 shadow transition z-10">
                    <i data-feather="chevron-left"></i>
                </button>
                <button id="carouselNext" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-amber-100 rounded-full p-2 shadow transition z-10">
                    <i data-feather="chevron-right"></i>
                </button>
                <!-- Dots -->
                <div id="carouselDots" class="absolute bottom-3 left-1/2 -translate-x-1/2 flex space-x-2"></div>
            </div>
        </section>

        <!-- Flash Sale Section -->
        <section class="mb-10">
            <div class="flex items-center justify-between mb-2">
                <h2 class="text-xl font-bold text-amber-800">Flash Sale</h2>
                <div class="flex items-center space-x-2">
                    <span class="text-sm font-semibold text-gray-700">Ends in</span>
                    <span id="flashCountdown" class="bg-red-600 text-white px-2 py-1 rounded font-mono text-sm"></span>
                </div>
            </div>
            <div class="flex space-x-4 overflow-x-auto no-scrollbar pb-2" id="flashSaleProducts">
                <!-- Flash sale products will be injected here -->
            </div>
        </section>

        <!-- Just For You Section -->
        <section class="mb-10">
            <h2 class="text-xl font-bold text-amber-800 mb-2">Just For You</h2>
            <div class="flex space-x-4 overflow-x-auto no-scrollbar pb-2" id="recommendedProducts">
                <!-- Recommended products will be injected here -->
            </div>
        </section>

        <!-- Popular Categories Grid -->
        <section class="mb-10">
            <h2 class="text-xl font-bold text-amber-800 mb-4">Popular Categories</h2>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4" id="popularCategories">
                <!-- Popular categories will be injected here -->
            </div>
        </section>

        <!-- Category Sections -->
        <section id="categorySections">
            <!-- Category-wise product sections will be injected here -->
        </section>

    </main>

    <!-- Product Details Modal -->
    <div id="productModal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-bg absolute inset-0"></div>
        <div class="relative bg-white rounded-xl shadow-xl max-w-lg w-full mx-4 p-6 z-10">
            <button id="closeModalBtn" class="absolute top-3 right-3 p-2 rounded-full hover:bg-amber-100 transition">
                <i data-feather="x"></i>
            </button>
            <div id="modalContent">
                <!-- Modal content will be injected here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-amber-900 text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 py-8 grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h3 class="font-bold mb-2">Amar Dokan</h3>
                <p class="text-sm">Your trusted online marketplace for quality furniture, decor, and more. Experience the warmth of wood in every product.</p>
            </div>
            <div>
                <h3 class="font-bold mb-2">Customer Service</h3>
                <ul class="text-sm space-y-1">
                    <li><a href="#" class="hover:underline">Help Center</a></li>
                    <li><a href="#" class="hover:underline">Returns</a></li>
                    <li><a href="#" class="hover:underline">Shipping Info</a></li>
                    <li><a href="#" class="hover:underline">Contact Us</a></li>
                </ul>
            </div>
            <div>
                <h3 class="font-bold mb-2">Follow Us</h3>
                <div class="flex space-x-4 mt-2">
                    <a href="#" class="hover:text-amber-300"><i data-feather="facebook"></i></a>
                    <a href="#" class="hover:text-amber-300"><i data-feather="twitter"></i></a>
                    <a href="#" class="hover:text-amber-300"><i data-feather="instagram"></i></a>
                </div>
            </div>
        </div>
        <div class="text-center text-xs py-2 bg-amber-950/80">Â© 2024 Amar Dokan. All rights reserved.</div>
    </footer>

    <!-- Product Data & Scripts -->
    <script>
        // Product Data
        const categories = [
            { id: 'furniture', name: 'Furniture', icon: 'grid' },
            { id: 'decor', name: 'Decor', icon: 'image' },
            { id: 'kitchenware', name: 'Kitchenware', icon: 'coffee' },
            { id: 'accessories', name: 'Accessories', icon: 'gift' },
        ];

        const products = [
            // Flash Sale
            {
                id: 1, name: "Solid Oak Dining Table", category: "furniture", price: 350, discount: 20, rating: 4.7,
                image: "https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=400&q=80",
                description: "A beautifully crafted solid oak dining table, perfect for family gatherings.",
                flashSale: true, recommended: true
            },
            {
                id: 2, name: "Modern Wooden Chair", category: "furniture", price: 120, discount: 15, rating: 4.5,
                image: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80",
                description: "Ergonomic and stylish, this chair fits any modern home.",
                flashSale: true, recommended: false
            },
            {
                id: 3, name: "Rustic Wall Clock", category: "decor", price: 60, discount: 25, rating: 4.2,
                image: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
                description: "A rustic wall clock that adds charm to your living room.",
                flashSale: true, recommended: true
            },
            {
                id: 4, name: "Bamboo Serving Tray", category: "kitchenware", price: 25, discount: 10, rating: 4.0,
                image: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80",
                description: "Eco-friendly bamboo tray for serving snacks and drinks.",
                flashSale: true, recommended: false
            },
            // Recommended
            {
                id: 5, name: "Handmade Vase", category: "decor", price: 45, discount: 0, rating: 4.6,
                image: "https://images.unsplash.com/photo-1503602642458-232111445657?auto=format&fit=crop&w=400&q=80",
                description: "A unique handmade vase to brighten up your space.",
                flashSale: false, recommended: true
            },
            {
                id: 6, name: "Wooden Cutlery Set", category: "kitchenware", price: 30, discount: 5, rating: 4.3,
                image: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
                description: "Durable and stylish wooden cutlery for your kitchen.",
                flashSale: false, recommended: true
            },
            {
                id: 7, name: "Minimalist Desk Lamp", category: "accessories", price: 80, discount: 10, rating: 4.8,
                image: "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&w=400&q=80",
                description: "A minimalist lamp to illuminate your workspace.",
                flashSale: false, recommended: true
            },
            {
                id: 8, name: "Leather Key Holder", category: "accessories", price: 18, discount: 0, rating: 4.1,
                image: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80",
                description: "Keep your keys organized with this stylish holder.",
                flashSale: false, recommended: true
            },
            // More products for categories
            {
                id: 9, name: "Classic Bookshelf", category: "furniture", price: 220, discount: 12, rating: 4.4,
                image: "https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=400&q=80",
                description: "A classic bookshelf for your home library.",
                flashSale: false, recommended: false
            },
            {
                id: 10, name: "Decorative Mirror", category: "decor", price: 70, discount: 8, rating: 4.5,
                image: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80",
                description: "A decorative mirror to enhance your room's look.",
                flashSale: false, recommended: false
            },
            {
                id: 11, name: "Wooden Salad Bowl", category: "kitchenware", price: 35, discount: 0, rating: 4.2,
                image: "https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80",
                description: "Perfect for serving fresh salads.",
                flashSale: false, recommended: false
            },
            {
                id: 12, name: "Desk Organizer", category: "accessories", price: 22, discount: 5, rating: 4.0,
                image: "https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&w=400&q=80",
                description: "Keep your desk tidy and organized.",
                flashSale: false, recommended: false
            }
        ];

        const carouselImages = [
            {
                src: "https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?auto=format&fit=crop&w=900&q=80",
                alt: "Big Sale on Furniture",
                caption: "Big Sale on Furniture - Up to 50% Off!"
            },
            {
                src: "https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=900&q=80",
                alt: "Decor Collection",
                caption: "New Decor Collection - Refresh Your Home"
            },
            {
                src: "https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=900&q=80",
                alt: "Kitchenware Essentials",
                caption: "Kitchenware Essentials - Best Prices"
            }
        ];

        // Utility Functions
        function formatPrice(price) {
            return '$' + price.toFixed(2);
        }
        function getDiscountedPrice(price, discount) {
            return price * (1 - discount / 100);
        }
        function getStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += `<i data-feather="${i <= Math.round(rating) ? 'star' : 'star'}" class="${i <= Math.round(rating) ? 'text-amber-500' : 'text-gray-300'} inline w-4 h-4"></i>`;
            }
            return stars;
        }

        // Render Category Navigation
        function renderCategories() {
            const catList = document.getElementById('categoryList');
            const mobileCatList = document.getElementById('mobileCategoryList');
            catList.innerHTML = '';
            mobileCatList.innerHTML = '';
            categories.forEach(cat => {
                catList.innerHTML += `
                    <li>
                        <a href="#cat-${cat.id}" class="flex items-center space-x-2 px-3 py-2 rounded hover:bg-amber-100 transition font-medium text-gray-700">
                            <i data-feather="${cat.icon}" class="w-4 h-4 text-amber-700"></i>
                            <span>${cat.name}</span>
                        </a>
                    </li>
                `;
                mobileCatList.innerHTML += `
                    <a href="#cat-${cat.id}" class="flex items-center space-x-1 px-3 py-1 rounded-full bg-amber-50 hover:bg-amber-100 transition text-sm font-medium text-amber-800">
                        <i data-feather="${cat.icon}" class="w-4 h-4"></i>
                        <span>${cat.name}</span>
                    </a>
                `;
            });
        }

        // Render Carousel
        let carouselIndex = 0;
        let carouselInterval;
        function renderCarousel() {
            const slides = document.getElementById('carouselSlides');
            const dots = document.getElementById('carouselDots');
            slides.innerHTML = '';
            dots.innerHTML = '';
            carouselImages.forEach((img, idx) => {
                slides.innerHTML += `
                    <div class="absolute inset-0 transition-opacity duration-700 ${idx === carouselIndex ? 'opacity-100 z-10' : 'opacity-0 z-0'} flex flex-col justify-end bg-cover bg-center" style="background-image:url('${img.src}')">
                        <div class="bg-gradient-to-t from-black/60 to-transparent p-6">
                            <h3 class="text-2xl md:text-3xl font-bold text-white drop-shadow">${img.caption}</h3>
                        </div>
                    </div>
                `;
                dots.innerHTML += `
                    <button class="w-3 h-3 rounded-full ${idx === carouselIndex ? 'bg-amber-700' : 'bg-gray-300'} focus:outline-none" data-idx="${idx}"></button>
                `;
            });
            feather.replace();
        }
        function nextCarousel() {
            carouselIndex = (carouselIndex + 1) % carouselImages.length;
            renderCarousel();
        }
        function prevCarousel() {
            carouselIndex = (carouselIndex - 1 + carouselImages.length) % carouselImages.length;
            renderCarousel();
        }
        function startCarouselAuto() {
            clearInterval(carouselInterval);
            carouselInterval = setInterval(nextCarousel, 5000);
        }

        // Render Flash Sale
        function renderFlashSale() {
            const flashProducts = products.filter(p => p.flashSale);
            const container = document.getElementById('flashSaleProducts');
            container.innerHTML = '';
            flashProducts.forEach(p => {
                container.innerHTML += productCardHTML(p, true);
            });
            feather.replace();
        }

        // Render Recommended
        function renderRecommended() {
            const recProducts = products.filter(p => p.recommended);
            const container = document.getElementById('recommendedProducts');
            container.innerHTML = '';
            recProducts.forEach(p => {
                container.innerHTML += productCardHTML(p, false);
            });
            feather.replace();
        }

        // Render Popular Categories
        function renderPopularCategories() {
            const container = document.getElementById('popularCategories');
            container.innerHTML = '';
            categories.forEach(cat => {
                // Find a product image for the category
                const prod = products.find(p => p.category === cat.id);
                container.innerHTML += `
                    <a href="#cat-${cat.id}" class="block rounded-xl shadow hover:scale-105 transition bg-white overflow-hidden group">
                        <div class="h-28 bg-cover bg-center" style="background-image:url('${prod ? prod.image : ''}')"></div>
                        <div class="p-3 flex items-center justify-between">
                            <span class="font-semibold text-amber-800">${cat.name}</span>
                            <i data-feather="${cat.icon}" class="w-5 h-5 text-amber-700"></i>
                        </div>
                    </a>
                `;
            });
            feather.replace();
        }

        // Render Category Sections
        function renderCategorySections() {
            const container = document.getElementById('categorySections');
            container.innerHTML = '';
            categories.forEach(cat => {
                const catProducts = products.filter(p => p.category === cat.id);
                if (catProducts.length === 0) return;
                container.innerHTML += `
                    <div class="mb-10" id="cat-${cat.id}">
                        <h2 class="text-xl font-bold text-amber-800 mb-2">${cat.name}</h2>
                        <div class="flex space-x-4 overflow-x-auto no-scrollbar pb-2">
                            ${catProducts.map(p => productCardHTML(p, false)).join('')}
                        </div>
                    </div>
                `;
            });
            feather.replace();
        }

        // Product Card HTML
        function productCardHTML(p, showFlashBadge) {
            const discounted = p.discount > 0;
            const finalPrice = discounted ? getDiscountedPrice(p.price, p.discount) : p.price;
            return `
                <div class="min-w-[220px] max-w-[220px] bg-white rounded-xl shadow-md hover:shadow-xl transition hover:scale-105 relative group cursor-pointer flex flex-col" data-id="${p.id}">
                    <div class="relative">
                        <img src="${p.image}" alt="${p.name}" class="w-full h-36 object-cover rounded-t-xl shadow-sm" />
                        ${showFlashBadge && p.discount > 0 ? `<span class="absolute top-2 left-2 bg-red-600 text-white text-xs font-bold px-2 py-0.5 rounded-full">-${p.discount}%</span>` : ''}
                        ${!showFlashBadge && p.discount > 0 ? `<span class="absolute top-2 left-2 bg-green-600 text-white text-xs font-bold px-2 py-0.5 rounded-full">-${p.discount}%</span>` : ''}
                    </div>
                    <div class="flex-1 flex flex-col p-3">
                        <div class="font-bold text-gray-800 mb-1 truncate">${p.name}</div>
                        <div class="flex items-center space-x-2 mb-1">
                            <span class="text-lg font-bold text-amber-800">${formatPrice(finalPrice)}</span>
                            ${discounted ? `<span class="text-xs text-gray-400 line-through">${formatPrice(p.price)}</span>` : ''}
                        </div>
                        <div class="flex items-center mb-2">${getStars(p.rating)}</div>
                        <button class="mt-auto px-3 py-1 rounded-full bg-amber-700 text-white font-semibold shadow hover:bg-amber-800 transition duration-200 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 translate-y-2 focus:opacity-100 focus:translate-y-0">Add to Cart</button>
                    </div>
                </div>
            `;
        }

        // Modal
        function showProductModal(productId) {
            const p = products.find(x => x.id == productId);
            if (!p) return;
            const discounted = p.discount > 0;
            const finalPrice = discounted ? getDiscountedPrice(p.price, p.discount) : p.price;
            document.getElementById('modalContent').innerHTML = `
                <div class="flex flex-col md:flex-row gap-6">
                    <img src="${p.image}" alt="${p.name}" class="w-full md:w-48 h-48 object-cover rounded-xl shadow" />
                    <div class="flex-1 flex flex-col">
                        <h3 class="text-2xl font-bold text-amber-800 mb-2">${p.name}</h3>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-xl font-bold text-amber-800">${formatPrice(finalPrice)}</span>
                            ${discounted ? `<span class="text-sm text-gray-400 line-through">${formatPrice(p.price)}</span>` : ''}
                            ${discounted ? `<span class="bg-green-600 text-white text-xs font-bold px-2 py-0.5 rounded-full">-${p.discount}%</span>` : ''}
                        </div>
                        <div class="flex items-center mb-2">${getStars(p.rating)}</div>
                        <p class="text-gray-700 mb-4">${p.description}</p>
                        <button class="px-4 py-2 rounded-full bg-amber-700 text-white font-semibold shadow hover:bg-amber-800 transition duration-200 w-max" id="modalAddToCartBtn" data-id="${p.id}">Add to Cart</button>
                    </div>
                </div>
            `;
            document.getElementById('productModal').classList.remove('hidden');
            feather.replace();
        }
        function hideProductModal() {
            document.getElementById('productModal').classList.add('hidden');
        }

        // Cart
        let cart = [];
        function updateCartCount() {
            document.getElementById('cartCount').textContent = cart.length;
        }
        function addToCart(productId) {
            cart.push(productId);
            updateCartCount();
        }

        // Flash Sale Countdown
        let flashSaleEnd = new Date();
        flashSaleEnd.setHours(flashSaleEnd.getHours() + 2); // 2 hours from now
        function updateFlashCountdown() {
            const now = new Date();
            let diff = Math.max(0, flashSaleEnd - now);
            let h = Math.floor(diff / (1000 * 60 * 60));
            let m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            let s = Math.floor((diff % (1000 * 60)) / 1000);
            document.getElementById('flashCountdown').textContent =
                `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        // Search
        function searchProducts(query) {
            query = query.trim().toLowerCase();
            if (!query) return;
            // Find products matching name or description
            const results = products.filter(p =>
                p.name.toLowerCase().includes(query) ||
                p.description.toLowerCase().includes(query)
            );
            // Show results in a modal
            document.getElementById('modalContent').innerHTML = `
                <h3 class="text-xl font-bold text-amber-800 mb-4">Search Results</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    ${results.length ? results.map(p => `
                        <div class="bg-white rounded-xl shadow-md hover:shadow-xl transition hover:scale-105 relative group cursor-pointer flex flex-col" data-id="${p.id}">
                            <img src="${p.image}" alt="${p.name}" class="w-full h-28 object-cover rounded-t-xl shadow-sm" />
                            <div class="flex-1 flex flex-col p-3">
                                <div class="font-bold text-gray-800 mb-1 truncate">${p.name}</div>
                                <div class="flex items-center space-x-2 mb-1">
                                    <span class="text-lg font-bold text-amber-800">${formatPrice(getDiscountedPrice(p.price, p.discount))}</span>
                                    ${p.discount > 0 ? `<span class="text-xs text-gray-400 line-through">${formatPrice(p.price)}</span>` : ''}
                                </div>
                                <div class="flex items-center mb-2">${getStars(p.rating)}</div>
                            </div>
                        </div>
                    `).join('') : `<div class="col-span-2 text-gray-500">No products found.</div>`}
                </div>
            `;
            document.getElementById('productModal').classList.remove('hidden');
            feather.replace();
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            renderCategories();
            renderCarousel();
            renderFlashSale();
            renderRecommended();
            renderPopularCategories();
            renderCategorySections();
            updateCartCount();
            updateFlashCountdown();
            feather.replace();

            // Carousel controls
            document.getElementById('carouselPrev').onclick = () => { prevCarousel(); startCarouselAuto(); };
            document.getElementById('carouselNext').onclick = () => { nextCarousel(); startCarouselAuto(); };
            document.getElementById('carouselDots').onclick = e => {
                if (e.target.tagName === 'BUTTON') {
                    carouselIndex = parseInt(e.target.dataset.idx);
                    renderCarousel();
                    startCarouselAuto();
                }
            };
            startCarouselAuto();

            // Flash sale countdown
            setInterval(updateFlashCountdown, 1000);

            // Product card click (delegated)
            document.body.addEventListener('click', e => {
                // Product card click
                let card = e.target.closest('.group[data-id]');
                if (card && !e.target.closest('button')) {
                    showProductModal(card.dataset.id);
                }
                // Add to cart button
                if (e.target.closest('button') && e.target.closest('button').textContent.trim() === 'Add to Cart') {
                    let pid = card ? card.dataset.id : e.target.closest('button').dataset.id;
                    addToCart(pid);
                }
            });

            // Modal close
            document.getElementById('closeModalBtn').onclick = hideProductModal;
            document.getElementById('productModal').onclick = e => {
                if (e.target.classList.contains('modal-bg')) hideProductModal();
            };

            // Modal add to cart
            document.getElementById('modalContent').onclick = e => {
                if (e.target.id === 'modalAddToCartBtn') {
                    addToCart(e.target.dataset.id);
                }
            };

            // Search
            document.getElementById('searchBtn').onclick = () => {
                const q = document.getElementById('searchInput').value;
                searchProducts(q);
            };
            document.getElementById('searchInput').addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    searchProducts(e.target.value);
                }
            });
            // Mobile search
            document.getElementById('mobileSearchBtn').onclick = () => {
                const bar = document.getElementById('mobileSearchBar');
                bar.classList.toggle('hidden');
                if (!bar.classList.contains('hidden')) {
                    document.getElementById('mobileSearchInput').focus();
                }
            };
            document.getElementById('mobileSearchInput').addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    searchProducts(e.target.value);
                }
            });
        });
    </script>
</body>
</html>
